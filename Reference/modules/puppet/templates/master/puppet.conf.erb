#
# Puppet master configuration
#
[main]
logdir=/var/log/puppet
vardir=/var/lib/puppet
ssldir=/var/lib/puppet/ssl
rundir=/var/run/puppet
factpath=$vardir/lib/facter
# This allows the usage of templates within the environment as well as modules defualt template dir
templatedir=$confdir/templates:$confdir/environments/$environment/templates
#prerun_command=/etc/puppet/etckeeper-commit-pre
#postrun_command=/etc/puppet/etckeeper-commit-post
pluginsync = true

[master]

## Environments
## Master module paths are dynamically set using environment variable from agent.
## Modules are autoloaded and not statically imported, this allows us to use "core" modules aswell as enviro specific.
modulepath = $confdir/environments/$environment/modules:$confdir/modules/core
manifest = $confdir/environments/$environment/manifests/site.pp

# These are needed when the puppetmaster is run by passenger
# and can safely be removed if webrick is used.
ssl_client_header = SSL_CLIENT_S_DN 
ssl_client_verify_header = SSL_CLIENT_VERIFY
autosign =  false 
certname = <%= puppet_certname %>
ca = false

# Used to pull commit revision from local svn to replace the config verion on each catalog compile.
config_version = /etc/puppet/get_svn_version

# Inventory service, this will store a local yaml copy and also write to the puppeteer.
# This allows us to have a central repo of yaml facts/data on the puppeteer to use in dashboard/foreman
facts_terminus = rest
inventory_server = puppeteer.londen01.infra.ntt.eu
inventory_port = 8140

[agent]
certname = <%= puppet_certname %>
ca_server = puppeteer.londen01.infra.ntt.eu
server = puppeteer.londen01.infra.ntt.eu
reportserver = puppeteer.londen01.infra.ntt.eu
report = <%= puppet_report %>
environment = <%= puppet_environment %>

[production]
# Default environment
manifest = $confdir/manifests/site.pp

[dev]
# Development environment
#modulepath = $confdir/environments/dev/modules
#manifest = $confdir/environments/dev/manifests/site.pp
