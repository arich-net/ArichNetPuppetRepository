<VirtualHost <%= scope.lookupvar("foreman::params::foreman_host") %>:80>
  ServerName puppeteer.londen01.infra.ntt.eu
  ServerAlias foreman
  DocumentRoot <%= scope.lookupvar 'foreman::params::app_root' %>/public
  PassengerAppRoot <%= scope.lookupvar 'foreman::params::app_root' %>

  RailsAutoDetect On
  AddDefaultCharset UTF-8

</VirtualHost>

<VirtualHost <%= scope.lookupvar("foreman::params::foreman_host") %>:443>
  ServerName puppeteer.londen01.infra.ntt.eu
  ServerAlias foreman

  RailsAutoDetect On
  DocumentRoot <%= scope.lookupvar 'foreman::params::app_root' %>/public
  PassengerAppRoot <%= scope.lookupvar 'foreman::params::app_root' %>

  # Use puppet certificates for SSL

  SSLEngine On
  SSLCertificateFile /var/lib/puppet/ssl/certs/puppeteer.londen01.infra.ntt.eu.pem
  SSLCertificateKeyFile /var/lib/puppet/ssl/private_keys/puppeteer.londen01.infra.ntt.eu.pem
  SSLCertificateChainFile /var/lib/puppet/ssl/certs/ca.pem
  SSLCACertificateFile /var/lib/puppet/ssl/certs/ca.pem
  SSLVerifyClient optional
  SSLOptions +StdEnvVars
  SSLVerifyDepth 3

</VirtualHost>